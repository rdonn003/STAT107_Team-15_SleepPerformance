---
title: 'Stat107 Final Project Data Cleaning'
author: "Group 15"
date: "11-5-25"
output:
  pdf_document: default
  html_document:
    css: ../lab.css
    highlight: pygments
    theme: cerulean
---

```{r load-data}
sleep_data <- read.csv("sleep_deprivation_dataset_detailed.csv")
head(sleep_data)
```

In order to ensure the data is ready for use in our analysis, we must first clean it such that each variable is formatted in a predicatble manner and there are not missing data values. To do this we define the below functions:

```{r}
#######################################################
##These functions are taken from DA6
#######################################################
remove_na <- function(df) { ## Automatize the removal of missing observations.
  n_obs <- nrow(df)
  missing <- rep(FALSE, n_obs)
  for (obs_ind in 1:n_obs) {
    obs <- df[obs_ind, ]
    n_missing <- sum(is.na(obs))
    if(n_missing > 0) {
      missing[obs_ind] <- TRUE
    }
  }
  df_red <- df[!missing, ]

  return(df_red)
}

#######################################################
#######################################################
to_factors <- function(df) { ## Turn all character variables to factors.
  n_vars <- ncol(df)
  for (var_ind in 1:n_vars) {
    var <- df[, var_ind]
    if (class(var) == "character") {
      df[, var_ind] <- factor(var)
    }
  }
  return(df)
}

```

Apply the functions to the data set:

```{r}
sleep_df <- to_factors(remove_na(sleep_data))
head(sleep_df)
```

Remove outliers? 


Export the now cleaned data:

```{r}
save(sleep_df, file = "sleep_df.RData")
```


Here we are able to quickly visualize what numeric variables relate to each other and the strength of these relationships. As the correlation plot shows the variables with positively correlated relationships are those in blue, the darker the blue color of the circles the stronger that positive relationship is. And for the red colored circles is a negative correlated for example in our data set it is apparent that the less sleep you get the less the N_Back_Accuracy score is(memory capabilities/attention). 
```{r}

#Visualize correlation between the numeric variables in our data set

install.packages("corrplot") 
library(corrplot)
numeric_var <- c( "Sleep_Hours", "Stroop_Task_Reaction_Time", "N_Back_Accuracy", "PVT_Reaction_Time" , "BMI", "Sleep_Quality_Score", "Stress_Level" )
cor_mat <- cor(sleep_df[, numeric_var])
corrplot(cor_mat)




```
